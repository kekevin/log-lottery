import{a as e}from"./chunk-Cv_h2SVa.js";import{b as a,s,r as t,l,h as n,w as i,o as r,e as o,f as c,n as m,F as u,y as d,k as v,z as p,j as g}from"./chunk-CuXAu-_P.js";import{u as f,f as h}from"./chunk-CK6zyU60.js";const k={class:"toast toast-top toast-end"},y={key:0,class:"alert alert-error"},b=[c("span",null,"上传失败",-1)],w={key:1,class:"alert alert-success"},I=[c("span",null,"上传成功",-1)],x={key:2,class:"alert alert-error"},C=[c("span",null,"不是图片",-1)],j={class:""},S={for:"explore"},T=["accept"],_=c("span",{class:"btn btn-primary btn-sm"},"上传图片",-1),q={class:"p-0"},z={class:"flex items-center gap-8"},D={class:"avatar h-14"},F={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},L={class:"w-64"},N={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},U=["onClick"],A=a({__name:"ImageConfig",setup(a){const A=f().globalConfig,{getImageList:B}=s(A),E=t("image/*"),G=t(0),H=l.createInstance({name:"imgStore"}),J=async a=>{if(!/image*/.test(a.target.files[0].type))return void(G.value=3);let{dataUrl:s,fileName:t}=await e(a.target.files[0]);H.setItem((new Date).getTime().toString()+"+"+t,s).then((()=>{G.value=1,K()})).catch((()=>{G.value=2}))},K=async()=>{(await H.keys()).length>0&&H.iterate(((e,a)=>{A.addImage({id:a,name:a,url:"Storage"})}))};return n((()=>{})),i((()=>G.value),(e=>{0!==e&&setTimeout((()=>{G.value=0}),2e3)})),(e,a)=>(r(),o(u,null,[c("div",k,[2==G.value?(r(),o("div",y,b)):m("",!0),1==G.value?(r(),o("div",w,I)):m("",!0),3==G.value?(r(),o("div",x,C)):m("",!0)]),c("div",null,[c("div",j,[c("label",S,[c("input",{type:"file",class:"",id:"explore",style:{display:"none"},onChange:J,accept:E.value},null,40,T),_])]),c("ul",q,[(r(!0),o(u,null,d(g(B),(e=>(r(),o("li",{key:e.id,class:"mb-3"},[c("div",z,[c("div",D,[c("div",F,[v(h,{imgItem:e},null,8,["imgItem"])])]),c("div",L,[c("div",N,p(e.name),1)]),c("div",null,[c("button",{class:"btn btn-error btn-xs",onClick:a=>(e=>{"Storage"==e.url&&H.removeItem(e.id).then((()=>{A.removeImage(e.id)})),A.removeImage(e.id)})(e)},"删除",8,U)])])])))),128))])])],64))}});export{A as default};
