import{b as e,r as t,l as a,s,h as n,o as l,e as i,f as r,F as c,y as o,z as u}from"./chunk-CuXAu-_P.js";import{a as m}from"./chunk-Cv_h2SVa.js";import{u as p}from"./chunk-CK6zyU60.js";const b={class:"flex gap-3"},d={for:"explore"},f=["accept"],g=r("span",{class:"btn btn-primary btn-sm"},"上传音乐",-1),v={class:"p-0"},y={class:"mr-12 overflow-hidden w-72 whitespace-nowrap text-ellipsis"},k={class:"flex gap-3"},h=["onClick"],C=["onClick"],x=e({__name:"MusicConfig",setup(e){const x=t(0),w=a.createInstance({name:"audioStore"}),M=p().globalConfig,{getMusicList:S}=s(M),j=t("audio/*"),I=t(S),L=()=>{M.resetMusicList(),w.clear()},D=()=>{M.clearMusicList(),w.clear()},T=async()=>{(await w.keys()).length>0&&w.iterate(((e,t)=>{M.addMusic({id:t+(new Date).getTime().toString(),name:t,url:"Storage"})}))},_=async e=>{if(!/audio*/.test(e.target.files[0].type))return void(x.value=3);let{dataUrl:t,fileName:a}=await m(e.target.files[0]);w.setItem((new Date).getTime().toString()+"+"+a,t).then((()=>{x.value=1,T()})).catch((()=>{x.value=2}))};return n((()=>{T()})),(e,t)=>(l(),i("div",null,[r("div",b,[r("button",{class:"btn btn-primary btn-sm",onClick:L},"重置音乐列表"),r("label",d,[r("input",{type:"file",class:"",id:"explore",style:{display:"none"},onChange:_,accept:j.value},null,40,f),g]),r("button",{class:"btn btn-error btn-sm",onClick:D},"删除所有")]),r("div",null,[r("ul",v,[(l(!0),i(c,null,o(I.value,(e=>(l(),i("li",{key:e.id,class:"flex items-center gap-6 pb-2 mb-3 divide-y"},[r("div",y,[r("span",null,u(e.name),1)]),r("div",k,[r("button",{class:"btn btn-primary btn-xs",onClick:t=>(async e=>{M.setCurrentMusic(e,!1)})(e)},"播放",8,h),r("button",{class:"btn btn-error btn-xs",onClick:t=>(e=>{M.removeMusic(e.id),w.removeItem(e.name)})(e)},"删除",8,C)])])))),128))])])]))}});export{x as default};
